<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zasięg GreenMax</title>
    <style>
         .menu-container{
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            cursor: pointer;
            z-index: 1000; /* Aby przycisk był nad innymi elementami */
        }
        .menu-bar {
            width: 30px;
            height: 3px;
            background-color: #f2f5f3; /* Kolor pasków */
            margin: 5px 0;
            transition: 0.3s;
        }

        .menu-container:hover .menu-bar {
            background-color: #ccc; /* Kolor pasków przy najechaniu */
        }

        /* Stylizacja menu */
        .menu {
            display: none;
            position: absolute;
            top: 35px;
            right: 0;
            background-color: #f2f5f3;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            z-index: 1000;
        }

        .menu a {
            display: block;
            color: #000;
            text-decoration: none;
            padding: 10px;
        }

        .menu a:hover {
            background-color: #e0e0e0;
        }

        /* Stylizacja po kliknięciu w przycisk menu */
        .menu-container.active .menu {
            display: block;
        }
        body {
            font-family: Arial, sans-serif;
            background-color: #f2f5f3;
            color: #37453b;
        }
        .search-container {
            margin: 20px 0;
            position: relative;
        }
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            border: 1px solid #ccc;
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
            width: 100%;
        }
        .search-results li {
            padding: 10px;
            cursor: pointer;
            color: black; /* Ustawia czarny kolor czcionki */
        }
        .search-results li:hover {
            background-color: #ddd;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: none;
        }
        .legend {
            margin-top: 20px;
            display: flex;
            gap: 15px;
            justify-content: flex-start;
        }
        .legend div {
            display: flex;
            align-items: center;
        }
        .legend div span {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .red-black { background-color: red; }
        .green { background-color: green; }
        .blue { background-color: blue; }
    </style>
</head>
<body>

<h1>Zasięg GreenMax</h1>

<div class="search-container">
    <input type="text" id="search" placeholder="Wyszukaj gminę..." style="width: 100%; padding: 10px;">
    <ul id="search-results" class="search-results"></ul>
</div>

<!-- Iframe z mapą -->
<iframe id="map" src="https://www.google.com/maps/d/u/0/embed?mid=1qV0QjIFOrcRKK3G6mKE073h6FGbU9pY&ehbc=2E312F&noprof=1"></iframe>

<!-- Legenda -->
<div class="legend">
    <div><span class="red-black"></span>Gmina nieodwiedzona</div>
    <div><span class="green"></span>Gmina zaulotkowana</div>
    <div><span class="blue"></span>Gmina zaulotkowana przez Astridę</div>
</div>
     <div class="menu-container" onclick="toggleMenu()">
    <div class="menu-bar"></div>
    <div class="menu-bar"></div>
    <div class="menu-bar"></div>
    <div class="menu">
        <a href="#" id="calendar-link">Kalendarz spotkań</a>
        <a href="#" id="schedule-link" target="_blank">Harmonogram map</a>
        <a href="#" id="report-link">Raporty ulotkarzy</a>
        <a href="#" id="range-link">Zasięg ulotkowania</a>
    </div>
          <script>
    // Funkcja do przełączania widoczności menu
    function toggleMenu() {
        document.querySelector('.menu-container').classList.toggle('active');
    }

    // Ustawienie linków w menu
    document.getElementById('calendar-link').href = 'https://doragon05.github.io/kalendarz_gmin/'; // Link do aktualnej strony (kalendarz)
    document.getElementById('schedule-link').href = 'https://greenmax2020.sharepoint.com/:x:/s/dzial-terenowych-sil-sprzedazy/ETzLx_rPRsFNt1ooG8RK0_4BLarL4zLC5eYuqq9gZu1Lgw'; // Podstaw link do harmonogramu tutaj
    document.getElementById('report-link').href = 'https://doragon05.github.io/kalendarz_gmin/raporty.html'; // Link do aktualnej strony (kalendarz)
    document.getElementById('range-link').href = 'https://doragon05.github.io/kalendarz_gmin/zasieg/zasieg.html'; // Link do aktualnej strony (kalendarz)
</script>

<script>
    const kmlUrl = './mapa.kml';  // Upewnij się, że plik KML jest na serwerze

    let gminy = [];

    // Pobieranie danych z KML
    fetch(kmlUrl)
        .then(response => response.text())
        .then(kmlText => {
            const parser = new DOMParser();
            const kml = parser.parseFromString(kmlText, 'application/xml');
            const placemarks = kml.getElementsByTagName('Placemark');
            
            for (let i = 0; i < placemarks.length; i++) {
                const name = placemarks[i].getElementsByTagName('name')[0].textContent;
                const coordinates = placemarks[i].getElementsByTagName('coordinates')[0].textContent.trim().split(',');
                
                gminy.push({
                    name: name,
                    lat: parseFloat(coordinates[1]),
                    lng: parseFloat(coordinates[0])
                });
            }
        });

    // Funkcja obsługująca wyszukiwanie
    document.getElementById('search').addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        const searchResults = document.getElementById('search-results');
        searchResults.innerHTML = '';

        // Filtruj wyniki
        const filteredGminy = gminy.filter(gmina => gmina.name.toLowerCase().includes(searchTerm)).slice(0, 4);

        filteredGminy.forEach(gmina => {
            const li = document.createElement('li');
            li.textContent = gmina.name;
            li.addEventListener('click', function() {
                // Skrypt do zmiany widoku iframe na odpowiednią gminę
                const mapIframe = document.getElementById('map');
                const lat = gmina.lat;
                const lng = gmina.lng;

                // Ustawia nową lokalizację i przybliżenie dla iframe (trzeba eksperymentować z poziomem przybliżenia)
                mapIframe.src = `https://www.google.com/maps/d/u/0/embed?mid=1O5dDyh...&ll=${lat},${lng}&z=10`;
            });
            searchResults.appendChild(li);
        });
    });
</script>

</body>
</html>
